# rust-comm Configuration File
#
# This file configures the Serial MCP Server and TUI application.
#
# Configuration Resolution Order:
# 1. RUST_COMM_CONFIG environment variable (explicit path)
# 2. ./config.toml (current directory)
# 3. ~/.config/rust-comm/config.toml (Linux/macOS)
# 4. %APPDATA%\rust-comm\config.toml (Windows)
# 5. Built-in defaults
#
# Environment variables can override any value using the pattern:
# RUST_COMM_<SECTION>_<KEY>=value
# Example: RUST_COMM_SERVER_PORT=8080

# =============================================================================
# Server Configuration
# =============================================================================
[server]
# Host address to bind to
host = "127.0.0.1"

# Port number for HTTP server (when using --server flag)
port = 3000

# Server mode: "mcp" (default), "rest", or "stdio"
mode = "mcp"

# Log level: "trace", "debug", "info", "warn", "error"
log_level = "info"

# =============================================================================
# Serial Port Configuration
# =============================================================================
[serial]
# Default baud rate for new connections
default_baud = 115200

# Default timeout in milliseconds
default_timeout_ms = 1000

# Enable auto-discovery of serial ports
auto_discover = true

# Discovery refresh interval in milliseconds
discovery_interval_ms = 5000

# Port aliases for convenience
# Use these names instead of full port paths
[serial.port_aliases]
# arduino = "COM3"
# esp32 = "COM22"
# ftdi = "/dev/ttyUSB0"
# rpi = "/dev/serial0"

# =============================================================================
# Hardware Testing Configuration
# =============================================================================
[testing]
# Test port name (leave empty to use auto-discovery)
# port = "COM22"

# Test baud rate
baud = 115200

# Whether loopback is enabled on test port
# Set to true if TX/RX pins are connected for echo testing
loopback_enabled = false

# Test timeout in milliseconds
timeout_ms = 2000

# Skip performance tests (useful for slow/old hardware)
skip_performance = false

# Auto-discovery settings for test port
[testing.discovery]
# Enable auto-discovery if port not explicitly set
enabled = true

# Preferred manufacturers for test port selection
# The first matching port will be used
prefer_manufacturers = ["FTDI", "ESP32", "Arduino", "CP210x", "CH340"]

# Ports to exclude from discovery (system ports, etc.)
exclude_ports = ["COM1", "COM2"]

# =============================================================================
# TUI Configuration
# =============================================================================
[tui]
# Theme: "dark", "light", "solarized", "dracula", "nord"
theme = "dark"

# Screen refresh rate in Hz (higher = smoother but more CPU)
refresh_rate_hz = 30

# Number of hex columns in hex view
hex_columns = 16

# Show timestamps in terminal output
show_timestamps = true

# Command history size (persisted between sessions)
history_size = 1000

# Custom keybindings
[tui.keybindings]
quit = "q"
clear = "ctrl+l"
send = "enter"
hex_mode = "ctrl+h"
help = "f1"
config = ":config"

# =============================================================================
# MCP Server Configuration
# =============================================================================
[mcp]
# Session database URL
# Use "sqlite::memory:?cache=shared" for in-memory (no persistence)
session_db = "sqlite://sessions.db"

# Maximum number of concurrent sessions
max_sessions = 100

# Session timeout in seconds (auto-close idle sessions)
session_timeout_secs = 3600

# =============================================================================
# Logging Configuration
# =============================================================================
[logging]
# Log file path (optional, leave empty for stderr only)
# file = "rust-comm.log"

# Max log file size in MB (for rotation)
max_size_mb = 10

# Log rotation: "daily", "hourly", "size"
rotation = "daily"

# Log format: "json", "pretty", "compact"
format = "pretty"
